unit CadCalculadora;

interface

uses
  Calculadora.Operacoes,
  Calculadora.Calculadora,
  Calculadora.Somar,
  Calculadora.Subtrair,
  Calculadora.Multiplicar,
  Calculadora.Dividir,
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Base, Vcl.ExtCtrls, Vcl.StdCtrls,
  System.Actions, Vcl.ActnList;

type
  TFCadCalculadora = class(TFBase)
    edtVisor: TLabeledEdit;
    btn7: TButton;
    btn8: TButton;
    btn9: TButton;
    btn4: TButton;
    btn5: TButton;
    btn6: TButton;
    btn1: TButton;
    btn2: TButton;
    btn3: TButton;
    btnLimpar: TButton;
    btnDividir: TButton;
    btMultiplicar: TButton;
    btnSomar: TButton;
    btnSubtrair: TButton;
    btnIgual: TButton;
    btn0: TButton;
    procedure btnSomarClick(Sender: TObject);
    procedure btnSubtrairClick(Sender: TObject);
    procedure btMultiplicarClick(Sender: TObject);
    procedure btnDividirClick(Sender: TObject);
    procedure btnClick(Sender: TObject);
    procedure btnLimparClick(Sender: TObject);
    procedure btnIgualClick(Sender: TObject);
  private
    FUltimoNumero: Double;
    FTotal: Double;
    FOperacao: TCalculadoraOperacao;
    FCalculadora: TCalculadora;
    procedure Operacao;
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FCadCalculadora: TFCadCalculadora;

implementation

{$R *.dfm}

{ TFCadCalculadora }

procedure TFCadCalculadora.Operacao;
begin
  try
    case FOperacao of
      tcoSomar:       FCalculadora := TSomar.Create;
      tcoSubtrair:    FCalculadora := TSubtrair.Create;
      tcoMultiplicar: FCalculadora := TMultiplicar.Create;
      tcoDividir:     FCalculadora := TDividir.Create;
      tcoLimpar:
                begin
                  FUltimoNumero := 0;
                  edtVisor.Clear;
                  exit;
                end;
    end;
    FTotal := FCalculadora.Operacao(FTotal, StrToFloatDef(edtVisor.Text,0));
    edtVisor.Text := FTotal.ToString();
    FUltimoNumero := FTotal;
  finally
    FCalculadora.Free;
  end;
end;

procedure TFCadCalculadora.btMultiplicarClick(Sender: TObject);
begin
  inherited;
  Operacao;
  FOperacao := tcoMultiplicar;
end;

procedure TFCadCalculadora.btnClick(Sender: TObject);
begin
  inherited;
  if (FUltimoNumero = 0) then
    edtVisor.Text := Trim(TButton(Sender).Caption)
  else
    edtVisor.Text := edtVisor.Text + Trim(TButton(Sender).Caption);
  FUltimoNumero := StrToFloat(edtVisor.Text);
end;

procedure TFCadCalculadora.btnDividirClick(Sender: TObject);
begin
  inherited;
  Operacao;
  FOperacao := tcoDividir;
end;

procedure TFCadCalculadora.btnIgualClick(Sender: TObject);
begin
  inherited;
  Operacao;
end;

procedure TFCadCalculadora.btnLimparClick(Sender: TObject);
begin
  inherited;
  FOperacao := tcoLimpar;
  Operacao;
end;

procedure TFCadCalculadora.btnSomarClick(Sender: TObject);
begin
  inherited;
  Operacao;
  FOperacao := tcoSomar;
end;

procedure TFCadCalculadora.btnSubtrairClick(Sender: TObject);
begin
  inherited;
  Operacao;
  FOperacao := tcoSubtrair;
end;

end.
